<!DOCTYPE html>
<html>
<head>
    <title>Sistema de Delivery</title>
</head>
<body>

<h1>Cat√°logo de Produtos</h1>
<button type="button" onclick="carregarProdutos()">Carregar Produtos</button>
<ul id="lista_produtos"></ul>

<h2>Montar Pedido</h2>
<textarea id="itens" rows="5" cols="40">
[
    {"id": 1, "quantidade": 1}
]
</textarea>
<br>
<button type="button" onclick="enviarPedido()">Enviar Pedido</button>


<h2>Resultado:</h2>
<pre id="resultado"></pre>

<script>
async function carregarProdutos() {
    const resp = await fetch("http://127.0.0.1:8001/produtos");
    const dados = await resp.json();
    document.getElementById("lista_produtos").innerHTML =
        dados.map(p => `<li>${p.id} - ${p.nome} - R$ ${p.preco}</li>`).join("");
}

async function enviarPedido() {
    const itens = JSON.parse(document.getElementById("itens").value);

    const resp = await fetch("http://127.0.0.1:8002/pedidos", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify(itens)
    });

    const dados = await resp.json();
    document.getElementById("resultado").textContent = JSON.stringify(dados, null, 4);
}
</script>

</body>
</html>
